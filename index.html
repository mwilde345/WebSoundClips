<!DOCTYPE html>
<html>
    <head>
        <title>
            Sound Clips
        </title>
         <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> 
    </head>
  <body>
    <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
    <div id="player"></div>
    <div id="button1" >
        <button onclick="logTime()">Log Time</button>
    </div>
    <div id="button2">
        <button onclick="resetTime()">Reset</button>
    </div>
    <div id="button3">
        <button onclick="undoTime()">Undo</button>
    </div>
    <div id="output">
        <div class="col-md-2" id="tableContainer" >
            <table id="table" class="table">
                <thead>
                    <tr>
                        <th>Start</th><th>Stop</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');
        //https://www.youtube.com/watch?v=SrLZgP-OR6s
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: 'V_laNt7Sh6g',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          },
          origin: "https://www.youtube.com"
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          //setTimeout(stopVideo, 6000);
          //done = true;
        }
      }
      function stopVideo() {
        player.stopVideo();
      }
      var startPressed = false;
      var stopPressed = false;
      function logTime(){
          //add a link to each entry that moves the player to that time
          //check if time > .5 so we don't go negative
        if(stopPressed==false&&startPressed==false){
            startPressed=true;
        }
        if(startPressed==true){
            stopPressed=true;
            startPressed=false;
            insertTime(true);
            return;
        }
        if(stopPressed==true){
             startPressed=true;
             stopPressed=false;
             insertTime(false);
             return;
         }
      }

      function insertTime(isStart){
        var currentTime = (player.getCurrentTime()-.5).toFixed(3);
        var insertString = isStart? '<td><button onclick="seekTo(this)">'+currentTime+'</button></td>' : 
            '<td><button onclick="seekTo(this)">'+currentTime+'</button></td>';
        $insertedItem = $(insertString);
        if(isStart){
            $("#tableBody").append("<tr></tr>");
            $("#tableBody tr:last").append($insertedItem);
        }else{
            $("#tableBody td:last").after($insertedItem);
        }
        $insertedItem.find("button").addClass("btn btn-info");
      }

      function resetTime(){
          //add button to remove the last row.
          startPressed = false;
          stopPressed = false;
          $("#table tbody").empty();
      }

      function undoTime(){
        startPressed = !startPressed;
        stopPressed = !stopPressed;
        $("#table td:last").remove();
      }

      function seekTo(button){
          var time=$(button).html();
          player.seekTo(time);
      }
    </script>
  </body>
</html>